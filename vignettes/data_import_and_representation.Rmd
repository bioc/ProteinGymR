---
title: "Importation and representation of ProteinGym data"
author: 
    - name: Tram Nguyen
      affiliation: Center for Computational Biomedicine, Harvard Medical School
      email: Tram_Nguyen@hms.harvard.edu
    - name: Pascal Notin
      affiliation: Computer Science, University of Oxford
    - name: Aaron W Kollasch
      affiliation: Systems Biology, Harvard Medical School
    - name: Ludwig Geistlinger
      affiliation: Center for Computational Biomedicine, Harvard Medical School
package: ProteinGymR
output:
    BiocStyle::html_document:
      self_contained: yes 
      toc: true
      toc_float: true
      toc_depth: 2
      code_folding: show
date: "`r doc_date()`"
vignette: >
    %\VignetteIndexEntry{Accessing ProteinGymR Data}
    %\VignetteEncoding{UTF-8}
    %\VignetteEngine{knitr::rmarkdown}
editor_options: 
    markdown: 
      wrap: 80
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
    collapse = TRUE,
    comment = "#>",
    crop = NULL
)
```

# Installation

Install the package using Bioconductor. Start R and enter:

```{r, eval = FALSE}
if(!requireNamespace("BiocManager", quietly = TRUE))
        install.packages("BiocManager")
BiocManager::install("ProteinGymR")
```

# Setup

Now, load the package and dependencies used in the vignette.

```{r, message = FALSE}
library(ProteinGymR)
```

# Introduction

Predicting the effects of mutations in proteins is critical to many
applications, from understanding genetic disease to designing novel proteins
to address our most pressing challenges in climate, agriculture and
healthcare. Despite an increase in machine learning-based protein modeling
methods, assessing the effectiveness of these models is problematic due to
the use of distinct, often contrived, experimental datasets and variable
performance across different protein families.

ProteinGym v1.0 is a large-scale and holistic set of benchmarks specifically
designed for protein fitness prediction and design. It encompasses both a
broad collection of over 250 standardized deep mutational scanning assays,
spanning millions of mutated sequences, as well as curated clinical datasets
providing high-quality expert annotations about mutation effects.
Furthermore, ProteinGym reports the performance of a diverse set of over 40
high-performing models from various subfields (eg., mutation effects,
inverse folding) into a unified benchmark.

# Data

The `ProteinGymR` package provides analysis-ready from and related to 
ProteinGym (Notin et. al.,
[2023](https://papers.nips.cc/paper_files/paper/2023/hash/cac723e5ff29f65e3fcbb0739ae91bee-Abstract-Datasets_and_Benchmarks.html)).
The these datasets can be access by querying ExperimentHub with the package
name.

1.  Deep mutational scanning assay (DMS) scores from 216 assays measuring
the impact of all possible amino acid substitutions across 186 proteins.

2.  AlphaMissense pathogenicity scores for ~1.6 M substitutions in the
ProteinGym DMS data.


# Load the DMS data from ExperimentHub

```{r}
dms_data <- dms_substitutions()
```





View the `SingleCellExperiment` data.

```{r}
sce
```

Do some checking to make sure the data loaded correctly and is what we expected.
Here, we are viewing the cell information of the object. We see that there are
indeed 105329 cells and 20905 features.

```{r, Data check}
head(colData(sce)) 
```

# Visualization

For this dataset, the authors have provided us with their exact UMAP and tSNE
coordinates, as well as their color scheme representing the cell types from
their paper. This can be accessed in the metadata slot of the
`SingleCellExperiment` object with the `metadata()` function. To consistently
recreate their figures, let's plot using their provided reduced dimensionality
coordinates.

```{r, fig.wide=TRUE}
cell.color <- metadata(sce)$cell_color

gg <- plotUMAP(sce, color_by = "cell_type", text_by = "cell_type") 
gg + theme(legend.title=element_blank()) + 
    scale_color_manual(values=c(cell.color))
```

This plot is a recreation of Fig. 2C from Ximerakis & Holton et al. 2023.

<br>

We can also plot a tSNE with their provided coordinates.

```{r, plot provided tSNE, fig.wide=TRUE}
gg <- plotTSNE(sce, color_by = "cell_type", text_by = "cell_type") 
gg + theme(legend.title=element_blank()) + 
    scale_color_manual(values=c(cell.color))
```

# Reference

Ximerakis & Holton et al. (2023) Heterochronic parabiosis reprograms the mouse
brain transcriptome by shifting aging signatures in multiple cell types.
\emph{Nat Aging} 3, 327â€“345. doi: <https://doi.org/10.1038/s43587-023-00373-6>.

# Session Info

```{r, sesh info}
sessionInfo()
```
